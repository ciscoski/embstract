# Tools

## Install

Steps

* Create a virtual environment
* Install using `pip install -e D:\Dev\embstract\tools\python\`

## Linting

### clang-tidy

This document outlines the execution methods for `clang-tidy`, a tool that performs static analysis of C++ code to 
identify potential bugs and enforce coding style guidelines.

The `clang-tidy` configuration is contained in the `clang-tidy.yaml` located in `tools/linting/clang` folder.

#### Requirements

* clang >= 16.0

####  Leveraging a Compilation Database

When using a preset which inherits `Release` or `Debug` a compilation database is generated during the configuration process.
This database stores information about the compiler flags used for each source file. 
Utilizing this database is the recommended approach for linting with `clang-tidy`.

##### Linting all the code for a target:

```bash
run-clang-tidy -config-file ./tools/linting/clang/clang-tidy.yaml -p [target_build_path] [other-options]
```

- `[target_build_path]`: Path to target build path which contains the compilation database
- `[other-options]`: (Optional) Flags to configure `run-clang-tidy` ( run `run-clang-tidy --help` for a full list )

##### Linting selected files used for a target

```bash
clang-tidy -config-file ./tools/linting/clang/clang-tidy.yaml -p [target_build_path] [other-options] <source0> [... <sourceN>]
```

- `[target_build_path]`: Path to target build path which contains the compilation database
- `<source0> [... <sourceN>]`: Path to source code to analyze (there can be multiple)

####  Manual Execution (Without Compilation Database)

!!! warning
    This method is less common but can be useful for smaller projects or testing purposes.
    It requires manually providing the compiler flags used for your project.

```bash
clang-tidy -config-file ./tools/linting/clang/clang-tidy.yaml <compiler_flags> [options] <source0> [... <sourceN>]
```

Run the following command, replacing `<clang-tidy-path>` with the path to your `clang-tidy` executable, `<compiler_flags>` with the actual flags, and `<source_files>` with the list of source files to analyze:

- `<compiler_flags>`: Flags used by your compiler (e.g., -I<include_dir>)
- `[options]`: (Optional) Flags to configure Clang-Tidy (e.g., `--checks` to specify checks to run)
- `<source0> [... <sourceN>]`: List of source files to analyze

!!! Note
    When using the manual execution method, ensure the provided compiler flags accurately reflect those used during compilation to achieve optimal analysis results.

####  Additional Resources

For further details and advanced configurations, refer to the following resources:

* Clang-Tidy documentation: [https://clang.llvm.org/extra/clang-tidy/](https://clang.llvm.org/extra/clang-tidy/)
* Clang-Tidy naming convention documentation: [https://releases.llvm.org/17.0.1/tools/clang/tools/extra/docs/clang-tidy/checks/readability/identifier-naming.html](https://releases.llvm.org/17.0.1/tools/clang/tools/extra/docs/clang-tidy/checks/readability/identifier-naming.html)

Here's an improved version of the markdown documentation that aligns with the Python script you provided:

---

### PCLint

This section describes how to use `pclint`, a static analysis tool for C and C++ code that helps identify potential bugs, enforce coding standards, and ensure code quality. The `pclint` configuration files and related scripts are located in the `tools/linting/pclint` directory.

#### Requirements

* PCLintPlus >= 2.0

#### Using a Compilation Database

Similar to [`clang-tidy`](#leveraging-a-compilation-database), `pclint` relies on the compilation database generated by CMake (`compile_commands.json`). This database is essential for accurately analyzing the code within the context of the correct compiler options and include paths.

#### Running PCLint on All Code for a Target

To perform a full linting analysis on all source files associated with a specific build target, use the following command:

```shell
run-pclint --build-path [target_build_path] lint .\tools\linting\pclint\std.lnt [other-options]
```

- **`[target_build_path]`**: The path to the build directory that contains the `compile_commands.json` file.
- **`[other-options]`**: (Optional) Additional flags to customize the `run-pclint` behavior. Use `run-pclint --help` to view the complete list of available options.

#### Monitoring Files for Changes

The script can also be used to continuously monitor files for changes and automatically re-run `pclint` whenever a file is modified. This feature is useful during active development to ensure that code changes remain compliant with the project's coding standards.

To start monitoring:

```shell
run-pclint --build-path [target_build_path] watch .\tools\linting\pclint\std.lnt [target_build_path]
```

- **`[target_build_path]`**: The path to the build directory that contains the `compile_commands.json` file.
- **`[other-options]`**: (Optional) Additional flags to customize the `run-pclint` behavior. Use `run-pclint --help` to view the complete list of available options.


This command sets up file watchers on the relevant files in your project. Whenever a change is detected in the source code or build-related files, `pclint` is automatically executed to analyze the updated files.

#### Configuration and Execution Flow

1. **Compiler and Build Environment Detection**: The script automatically extracts necessary information from the CMake-generated cache files, including the compiler name and relevant flags. This ensures that `pclint` is invoked with the correct settings.

2. **Configuration File Generation**: The script generates temporary `lnt` configuration files, tailored to your specific build environment and project files. These files are crucial for guiding `pclint` through the analysis process.

3. **Linting Execution**: The generated configuration files are passed to `pclint`, which then performs the static analysis and produces a report detailing any potential issues found in the code.

#### Additional Options and Customization

Users can customize the linting process by specifying additional options and configuration files. The script supports a variety of options that can be used to tailor the analysis to specific needs or to focus on particular aspects of the code.

For more detailed information on available options and their usage, run:

```shell
run-pclint --help
```

This command will provide a comprehensive list of flags and options that can be used to customize the `pclint` analysis to suit different project requirements.